# 中传放心传 - 个人总结报告

## 个人主要贡献

 结合题目要求，构思网站的基本架构。首先需要网站最基本的 **首页**，然后需要用户的 **注册、登录页面**；同时还有利用邮箱的用户双因素验证以及找回密码的功能，因此还需要能够实现 **验证功能的页面** 和 **修改密码的页面**。为了实现文件上传和展示浏览的功能，还需要一个 **文件上传页面** 和一个 **文件展示页面**；用户还可以分享文件，因此还需要用户自己可视的 **共享文件列表的页面**；同时还需要验证被分享者获得的 **分享码是否正确的页面** 和 **可下载共享文件的页面**。对于匿名用户来说，要得到解密的共享文件需要将加密文件上传到另一个 **客户端网页**，从而得到解密文件。

<br>

- 中传放心传网页
    - layout.html：
        - 首页，首先确定了网站的整体风格和框架，后续的子页面在首页的基础上进行调整。为了方便`页面维护`，在左边设置了一个导航侧栏，用户可以按需进行页面跳转。此外，为了让已登录用户和匿名用户均可直接下载公开的文件，所以在首页中添加了一个`公开文件列表`。

    - signup.html：
        - 注册页面，利用一个注册表单收集用户的账号信息，传到后端数据库中，实现用户注册功能。  

    - login.html：
        - 登陆页面，利用一个登录表单来验证用户输入的账号和密码与后端数据库中存储的是否一致，实现用户登录功能。

    - 2fa.html：
        - 利用邮箱的双因素验证页面，利用一个验证表单，验证用户身份，保证账号安全。

    - find.html：
        - 找回密码页面，利用一个表单获得用户的邮箱，后端向该邮箱发送验证码，并跳转到 `passwd.html` 进行验证。

    - passwd.html：
        - 验证页面。利用一个表单验证用户输入的验证码是否与系统发送给该邮箱的验证码一致，若一致，跳转到 `changepasswd.html` 重设密码。

    - changepasswd.html：
        - 修改密码页面，利用一个表单重新收集用户的账号信息，传到后端数据库中修改该账号的密码，实现修改密码功能。

    - file_upload.html：
        - 文件上传页面，利用一个表单来实现用户的文件上传和备注描述，对文件的大小和类型进行限制，后端对获得的文件进行加密、数字签名、哈希等操作。

    - file.html：
        - 我的文件页面，利用一个文件列表来显示用户上传的文件（已加密）和备注，并显示该文件是否共享、公开，还允许用户对该文件进行如下载、下载签名文件、共享、删除等操作。对文件进行共享时，会出现下拉框来设置共享的截止时间及下载次数，上传成功后，就会显示分享码和分享链接。

    - shared_file.html：
        - 共享文件页面，利用一个文件列表来显示用户共享的文件（已加密）和备注，并显示该文件是否共享、公开，还允许用户对该文件进行如下载、下载签名文件、解密下载、取消共享等操作。

    - verify.html：
        - 分享码验证页面，被分享者通过获得的分享链接，就可进入此页面。利用一个表单来验证分享链接和分享码是否系统分发的一致，若一致，便跳转到 `opensharefile.html` 下载相应文件。
    
    
    - opensharefile.html：
        - 共享文件下载页面，利用一个文件列表来显示分享者共享的文件（已加密）和备注，还允许被分享者对该文件进行如下载加密文件、下载签名文件、解密下载（需登录）等操作。
    
    <br>

- 客户端网页
     
    - encypted_file_upload.html：
        - 加密文件上传页面，利用一个表单来获得待解密文件，同时还需数字签名文件、分享链接和分享码来验证上传者的身份，若验证成功，便跳转到 `De_file.html` 。

    - De_file.html：
        - 加密文件解密下载页面，利用一个文件列表来显示用户上传的文件，允许用户对该文件进行如解密下载、验证数字签名等操作。


## 关键技术

- AdminLTE

    - 是一款建立在 Bootstrap 和 jQuery 之上的开源的模板主题工具，提供了一系列响应的、可重复使用的组件，并内置了`多个模板页面`可自适应多种屏幕分辨率，能帮助开发者`快速创建`一个响应式的 HTML5 网页，不但美观，而且可省去很多写 CSS 与 JS 的工作量。

    - 我利用了 AdminLTE 内置的`模板页面`搭建了网页的整体结构，再结合我们小组的开发需求，对具体的部分进行细节调整以满足我们的要求，从而形成我们自己的网页。例如，`file_upload.html` 就是在 `layout.html` 的基础上，对 `content` 部分进行修改 —— 改为一个可实现文件上传的表单。

- WTForms 表单
    - 用于收集用户输入
    - 常见登录 / 注册框
    - 多种元素实现多种输入
    - 简化表单创建过程
    - 便于实现表单验证
        - 使用内置验证器
        - 自定义验证规则
    - 加固表单提交安全
    - 实现统一表单复用
    - Flask-WTF 表单创建过程
        - 创建 FlaskForm 子类
        - 定义表单字段
        - StringField
        - PasswordField
        - 在模板中引用

- jinja2 模板

    - 分离逻辑与显示
        -  `views` 文件夹中的 auth.py 和 anony.py 来实例化 WSGI 对象并处理运算逻辑；
        - `templates` 文件夹中的 `xxx.html` 来显示。
    - 因为该网站有很多的表单 —— 登录 / 注册表单、文件上传表单、分享码验证表单等，需要结合 jinja2 来实现。

- Bootstrap
    
- JavaScript
    

## 总结和心得
    
 在此次密码学应用实践的小组合作中，我主要负责的部分是网页设计与制作，从中让我收益颇丰。从小组第一次开会讨论该项目需要完成的内容和分工到每位组员去实践自己负责的内容，这过程中不仅巩固了以前所学过的知识，而且还学到了很多在课堂上未学过的知识，使我懂得了理论与实际相结合是很重要的，只有从理论中的出结论，才能真正掌握一项技术，从而提高自己的实际动手能力和独立思考的能力。
 网页设计与制作，只有把布局的基础打好，才能设计出成功的网页。因此，首先要做的就是要确定好网站的风格与结构，要同后端的同学分析讨论确定每个网页的功能，决定好后就要分步骤做好准备工作。我浏览了一些优秀的网页模板，借鉴其优秀之处，不好的地方在自己的网站上加以改良，从而使自己的网站更加美观。除此之外，本项目有很多功能需要表单来实现，因此创建 WTForms 表单和使用 jinja2 模板引用是完成该网页十分重要的技术。我就查找了相关的文档学习了 WTForms 表单和 jinja2 模板。在项目接近收尾的时候，我又对整个网站的网页进行了精修，使其更加简约美观。